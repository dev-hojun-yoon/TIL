# 25. 8. 8 (Fri)

* ElasticSearch
  * 인덱스를 위한 색인하기 위한 커스텀 애널라이저는 해당 인덱스 안의 settings 에 작성하고, mappings 에서 가져다 쓴다.
  * 변경을 위해서는 기존에 설정된 인덱스를 제거해야 한다.
  * 샘플
    ```
    https://www.elastic.co/docs/reference/elasticsearch/plugins/analysis-nori-speech

    PUT nori_sample
    {
      "settings": {
        "index": {
          "analysis": {
            "analyzer": {
              "my_analyzer": {
                "tokenizer": "nori_tokenizer",
                "filter": [
                  "my_posfilter"
                ]
              }
            },
            "filter": {
              "my_posfilter": {
                "type": "nori_part_of_speech",
                "stoptags": [
                  "NR"
                ]
              }
            }
          }
        }
      }
    }
    
    GET nori_sample/_analyze
    {
      "analyzer": "my_analyzer",
      "text": "여섯 용이"
    }
    ```
    ```
    PUT nori_sample
    {
      "settings": {
        "index": {
          "analysis": {
            "analyzer": {
              "my_analyzer": {
                "tokenizer": "nori_tokenizer",
                "filter": [ "nori_readingform" ]
              }
            }
          }
        }
      }
    }
    
    GET nori_sample/_analyze
    {
      "analyzer": "my_analyzer",
      "text": "鄕歌"
    }
    ```
    십만이천오백과 -> 숫자로 변경
    ３.２천 -> 3200 으로 콤마에 대한 후처리
    ```
    PUT nori_sample
    {
      "settings": {
        "index": {
          "analysis": {
            "analyzer": {
              "my_analyzer": {
                "tokenizer": "tokenizer_discard_puncuation_false",
                "filter": [
                  "part_of_speech_stop_sp", "nori_number"
                ]
              }
            },
            "tokenizer": {
              "tokenizer_discard_puncuation_false": {
                "type": "nori_tokenizer",
                "discard_punctuation": "false"
              }
            },
            "filter": {
                "part_of_speech_stop_sp": {
                    "type": "nori_part_of_speech",
                    "stoptags": ["SP"]
                }
            }
          }
        }
      }
    }
    
    GET nori_sample/_analyze
    {
      "analyzer": "my_analyzer",
      "text": "십만이천오백과 ３.２천"
    }
    ```
