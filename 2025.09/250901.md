# 25. 9. 1 (Mon)

* XAI: 설명 가능한 인공지능
  * 모델 불가지론적: 모델의 내부 구조를 알지못해도 모델이 예측을 어떻게 했는지를 설명하는 기법
    * SHAP: 설명력을 가지기 위한 패키지
    * LIME
* Pytorch
  * 신경망 구축에 사용되는 소프트웨어 기반 오픈 소스 딥 러닝 프레임워크
  * 텐서라고 하는 자료구조를 이용
  * !nvidia-smi: colab 에서 nvidia 정보를 확인할 수 있음
  * tensor 자료형끼리 형변환 함수: to
    * a_.to(torch.int64)
    * a_ = torch.tensor(a, dtype=torch.int32)
    * b_ = torch.tensor(b, dtype=bool) // b_ = torch.tensor(b, dtype=float) // bool, float 은 왜 torch 를 붙이지 않지?
  * numpy 쓰는 방식 그대로 쓸 수 있음
    * torch.ones((3,2))
    * a1 = torch.ones((3,2)).T (전치)
  * @ 기호는 내적을 의미, matmul 메소드를 사용할 수도 있다
  * t_a * a1 : 행렬의 곱셈
  * 자료형을 바꾸는 방법은 torch.tensor 를 쓰거나 t_a(torch 값).to(torch.int64) 를 쓸 수 있는 것임
    * float -> int 변환 시 소수점 이하는 버리기 때문에 손실에 주의
  * t_b.reshape(-1) # 1차원으로 reshape
    * t_b = torch.rand((3,5))
    * t_b.reshape(5, -1) # 자동으로 size 를 맞춰줄 수 있음
    * numpy 랑 사용방법이 같음
  * squeeze: 차원 중에서 값이 1인 불필요한 차원을 제거하는 역할
    * torch.zeros(1,2,1,4,1)
    * t.squeeze(0).shape
  * 주로 Tabuler 2차원 데이터에 시계열 차원이 더해져 3차원까지가 일반적
  * torch.manual_seed(1) // seed 값 고정
  * t2 = torch.normal(mean=0, std=2, size=(5,2))
  * 2 * 3 // 3 * 2 = 2 * 2 로 만든다. => 행렬곱 (내적)
  * Autograd
    * 수식의 기울기를 자동으로 계산하는 방법이다.
    * 미분 계산(기울기 계산)을 자동화하여 경사하강법을 구현하는 수고를 덜어준다.
    * w = torch.tensor(1.0, requires_grad=True) => 값이 1인 스칼라 텐서 w (weight 가중치)
      * w라는 변수가 다른 연산에 쓰일 때마다 그때의 값을 기억해두는 grad값을 내장
  * 경사하강법을 적용하기 위해서는 반복문 구현
    * 오차 함수를 random_tensor 미분 -> 기울기 -> 가중치 -> 오차감소 프로세스
  * 신경망 class 생성 // 데이터셋 class 생성 // 딥러닝 학습
  * from torch.utils.data import DataLoader
    * 텐서로 되어 있는 데이터를 모델에 우리가 원하는 개수, 형식대로 보낼 수 있게 만들어져 있는 클래스
  * from torch.utils.data import Dataset
    * pytorch 에서 데이터를 다루기 쉽게 만들어주는 클래스
    * Dataset을 상속받아서 서브클래스 안에서 우리가 하고자 하는 작업을 재정의
    * 재정의 클래스에서 재정의해야할 내장 함수가 지정된 것은 pydantic 역할인 건지 다시 확인이 필요하다
  * from torch.utils.data import TensorDataset
    * pytorch에서 데이터를 다루기 쉽게 만들어주는 클래스
    * tensor로 된 자료들을 X,y를 한데 묶어서 처리할 때 사용하는 클래스
  * 예시 코드
    ```
    import torch
    import numpy as np
    
    li1 = [1, 2, 3, 4] #  y
    li2 = [0.3, 1.0, 5., 22.]
    
    from torch.utils.data import TensorDataset 
    # pytorch에서 데이터를 다루기 쉽게 만들어주는 클래스 
    # tensor로 된 자료들을 X,y를 한데 묶어서 처리할 때 사용하는 클래스 
    
    ts_data_loader = TensorDataset(torch.tensor(li2), torch.tensor(li1))
    ts_data_loader
    
    from torch.utils.data import DataLoader # 텐서로 되어있는 데이터를 모델에 우리가 원하는 개수, 형식대로 보낼 수 있게 만들어져 있는 클래스
    
    data_loder = DataLoader(ts_data_loader, batch_size=2, shuffle=True, drop_last=True) # batch_size 한번에 넘길 데이터의 개수 - 전체 데이터를 개수가 맞지 않으면 마지막은 남는거 전부 
    
    for item in data_loder:
        print(item, type(item))
    ```
